<!DOCTYPE html>
<html>
<head>
	<title>Leaflet Layers Control Example</title>
	<meta charset="utf-8" />

	<meta name="viewport" content="width=device-width, initial-scale=1.0">

	<link rel="stylesheet" href="css/leaflet_mapbbcode.css">
    <link rel="stylesheet" href="css/style.css">
    
    <script src="js/leaflet.js"></script>
    
    <script src="js/bioregions_TEMP.js" type="text/javascript"></script>
    <script src="js/layerlist.js"></script>
    

</head>





<body>
	
	<p><select size="1" id="llselect"><input type="button" id="lladd" value="Show layer">
	<div id="map"></div></p>

	

	<script>
	
	function style(feature) {
		return {weight: 1.2, opacity: 1, color: "#DF5A49", fillOpacity: 0.6, fillColor: "#E27A3F"};
	}
	
	
	function createMap(div, coords) {
    	var map = L.map(div, { scrollWheelZoom: false }).setView([52, -115], 2);
    	map.addLayer(window.layerList.getLeafletLayer('OpenStreetMap'));
    	return map;
	}
	
	
	function onEachFeature(feature, layer) {
		var popupContent = "<p>Name:&nbsp;" + feature.properties.Name + "</p>"
		
		if (feature.properties && feature.properties.popupContent) {
			popupContent += feature.properties.popupContent;
		}
		
		layer.bindPopup(popupContent);
	}



	var map = createMap('map');


	var sel = document.getElementById('llselect');
	var layerKeys = window.layerList.getSortedKeys();

	for( var i = 0; i < layerKeys.length; i++ ) {
    	if( !window.layerList.requiresKey(layerKeys[i]) ) {
        	var opt = document.createElement('option');
        	opt.innerHTML = opt.value = layerKeys[i];
        	sel.appendChild(opt);
    	}
	}



	<!-- Add the geojson bioregions data -->
	bioregions = L.geoJson(bioregions, {
		style: style,
		filter: function (feature, layer) {
			if (feature.properties) {
				// If the property "underConstruction" exists and is true, return false (don't render features under construction)
				return feature.properties.underConstruction !== undefined ? !feature.properties.underConstruction : true;
			}
			return false;
			},
			onEachFeature: onEachFeature
		}).addTo(map);
		
		
	
	L.DomEvent.on(document.getElementById('lladd'), 'click', function() {
		map.eachLayer(function(layer) {
			map.removeLayer(layer);
			map.removeLayer(bioregions);
		});
    		map.addLayer(window.layerList.getLeafletLayer(sel.value));
			map.addLayer(bioregions);
		});
		

		//bioregions.bringToFront();




		
		
		

	</script>
</body>
</html>

